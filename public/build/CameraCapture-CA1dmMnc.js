import{r as t,R as e}from"./app2.js";import{a as P,F as U}from"./XMarkIcon-Dw0WrAo0.js";import{L as N}from"./dialog-D-Cuu6HU.js";function T({title:s,titleId:m,...u},b){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:b,"aria-labelledby":m},u),s?t.createElement("title",{id:m},s):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"}))}const R=t.forwardRef(T);function V({isOpen:s,onClose:m,onCapture:u,title:b="Take Photo"}){const o=t.useRef(null),p=t.useRef(null),[l,w]=t.useState(null),[c,g]=t.useState(!1),[y,x]=t.useState(null),[E,v]=t.useState(null),[f,j]=t.useState("environment"),i=t.useCallback(async r=>{try{x(null),l&&(l.getTracks().forEach(d=>d.stop()),w(null),g(!1));const a=r||f,n=await navigator.mediaDevices.getUserMedia({video:{facingMode:a,width:{ideal:1280},height:{ideal:720}}});w(n),o.current&&(o.current.srcObject=n,o.current.play(),g(!0))}catch(a){console.error("Error accessing camera:",a);let n="Unable to access camera. ";a.name==="NotAllowedError"?n+="Please allow camera permissions and try again.":a.name==="NotFoundError"?n+="No camera found on this device.":a.name==="NotSupportedError"?n+="Camera is not supported in this browser.":n+=a.message||"Unknown error occurred.",x(n),g(!1)}},[l,f]),h=t.useCallback(()=>{l&&(l.getTracks().forEach(r=>r.stop()),w(null)),g(!1)},[l]),M=t.useCallback(()=>{if(!o.current||!p.current)return;const r=o.current,a=p.current,n=a.getContext("2d");a.width=r.videoWidth,a.height=r.videoHeight,n.drawImage(r,0,0,a.width,a.height),a.toBlob(d=>{if(d){const L=new File([d],`photo-${Date.now()}.jpg`,{type:"image/jpeg",lastModified:Date.now()}),C=URL.createObjectURL(d);v(C),u(L,C)}},"image/jpeg",.9)},[u]),S=t.useCallback(()=>{const r=f==="user"?"environment":"user";j(r),c&&i(r)},[f,c,i]),F=t.useCallback(()=>{v(null),c||i()},[c,i]),k=t.useCallback(()=>{h(),v(null),x(null),m()},[h,m]);return e.useEffect(()=>{s&&!c&&!E&&i()},[s]),e.useEffect(()=>(s||h(),()=>{h()}),[s]),s?e.createElement(N,{open:s,onClose:k,className:"relative z-50"},e.createElement("div",{className:"fixed inset-0 bg-black/50","aria-hidden":"true"}),e.createElement("div",{className:"fixed inset-0 flex items-center justify-center p-4"},e.createElement(N.Panel,{className:"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl"},e.createElement("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700"},e.createElement(N.Title,{className:"text-lg font-semibold text-gray-900 dark:text-white"},b),e.createElement("button",{onClick:k,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},e.createElement(P,{className:"h-6 w-6"}))),e.createElement("div",{className:"p-4"},y?e.createElement("div",{className:"text-center py-8"},e.createElement("div",{className:"text-red-600 dark:text-red-400 mb-4"},e.createElement(R,{className:"h-16 w-16 mx-auto mb-2 opacity-50"}),e.createElement("p",{className:"text-sm"},y)),e.createElement("button",{onClick:i,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"},"Try Again")):E?e.createElement("div",{className:"text-center"},e.createElement("img",{src:E,alt:"Captured photo",className:"max-w-full max-h-96 mx-auto rounded-lg shadow-md"}),e.createElement("div",{className:"flex justify-center space-x-4 mt-4"},e.createElement("button",{onClick:F,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors"},"Retake"),e.createElement("button",{onClick:k,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors"},"Use Photo"))):e.createElement("div",{className:"relative"},e.createElement("video",{ref:o,className:"w-full max-h-96 bg-black rounded-lg",autoPlay:!0,playsInline:!0,muted:!0}),e.createElement("canvas",{ref:p,className:"hidden"}),c&&e.createElement("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-4"},e.createElement("button",{onClick:S,className:"p-3 bg-gray-600 text-white rounded-full hover:bg-gray-700 transition-colors",title:"Switch Camera"},e.createElement(U,{className:"h-5 w-5"})),e.createElement("button",{onClick:M,className:"p-4 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors",title:"Take Photo"},e.createElement(R,{className:"h-6 w-6"})))))))):null}export{V as C,R as F};
