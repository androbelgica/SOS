import{q as A,r as d,v as L,R as e,$ as U,Y as $,a as M}from"./app2.js";import{M as Y}from"./MainLayout-B06OhM-w.js";import{I as i}from"./InputLabel-BvFC6EAv.js";import{T as y,I as c}from"./InputError-ChmX8D1f.js";import{I as J}from"./ImageBrowser-foy8GHZg.js";import{C as K}from"./CameraCapture-CA1dmMnc.js";import{P as Q}from"./ProductRecognition-BeEbLMsP.js";import"./FlashMessage-CcTVzuzS.js";import"./NotificationDropdown-Bq8s4d9o.js";import"./transition-Cpe-sHT0.js";import"./dialog-D-Cuu6HU.js";import"./XMarkIcon-Dw0WrAo0.js";import"./CheckCircleIcon-C2jnGy7x.js";import"./SparklesIcon-Cbt0i-M0.js";function ue({auth:N,recipes:C,categories:k}){const{asset:z}=A().props,[H,V]=d.useState(Date.now()),[m,u]=d.useState(null),[x,E]=d.useState(!1),[h,g]=d.useState(null),[_,v]=d.useState(!1),[I,f]=d.useState(!1),[P,p]=d.useState(!1);d.useEffect(()=>{console.log("Create Product component mounted")},[]);const S=async()=>{var t,n;if(!a.name||a.name.trim()===""){g("Please enter a product name first");return}E(!0),g(null);try{const r=await M.post(route("api.ai.generate-product-info"),{product_name:a.name});r.data.success?(r.data.description&&s("description",r.data.description),r.data.nutritional_facts&&s("nutritional_facts",r.data.nutritional_facts)):g(r.data.message||"Failed to generate product information")}catch(r){console.error("AI Generation Error:",r),g(((n=(t=r.response)==null?void 0:t.data)==null?void 0:n.message)||"An error occurred during generation")}finally{E(!1)}},{data:a,setData:s,post:q,processing:w,errors:l,reset:F,progress:b}=L({name:"",description:"",nutritional_facts:"",price:"",stock_quantity:"",category:"",unit_type:"piece",image:null,recipe_ids:[]}),O=t=>{const n=t.target.files[0];if(s("image",n),n){const r=new FileReader;r.onload=o=>{u(o.target.result)},r.readAsDataURL(n)}},R=t=>{s("image_url",t.url),u(t.url)},B=(t,n)=>{s("image",t),u(n),f(!1)},T=()=>{s("image",null),s("image_url",null),u(null);const t=document.getElementById("image");t&&(t.value="")},j=t=>{const n=t.analysis;if(n.suggested_products&&n.suggested_products.length>0){const r=n.suggested_products[0];!a.name&&r.name&&s(o=>({...o,name:r.name})),!a.description&&r.description&&s(o=>({...o,description:r.description})),!a.price&&r.price&&s(o=>({...o,price:r.price.toString()}))}if(n.seafood_detected&&n.labels&&n.labels.length>0){const r=n.labels[0].description.toLowerCase();let o="";r.includes("fish")||r.includes("salmon")||r.includes("tuna")?o="fish":r.includes("shrimp")||r.includes("crab")||r.includes("lobster")?o="crustaceans":(r.includes("oyster")||r.includes("mussel")||r.includes("clam"))&&(o="shellfish"),o&&!a.category&&s(G=>({...G,category:o}))}p(!1)},D=t=>{t.preventDefault(),q(route("admin.products.store"),{forceFormData:!0,onSuccess:()=>{F(),u(null)}})};return e.createElement(Y,{auth:N},e.createElement(U,{title:"Create New Product"}),e.createElement("div",{className:"py-12"},e.createElement("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},e.createElement("div",{className:"p-6"},e.createElement("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-6"},"Create New Product"),e.createElement("form",{onSubmit:D,className:"space-y-6"},e.createElement("div",null,e.createElement("div",{className:"flex justify-between items-center"},e.createElement(i,{htmlFor:"name",value:"Name"}),e.createElement("button",{type:"button",onClick:()=>p(!0),className:"px-3 py-1 text-xs bg-purple-600 dark:bg-purple-500 text-white rounded-md hover:bg-purple-700 dark:hover:bg-purple-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 dark:focus:ring-purple-400 dark:focus:ring-offset-gray-800"},"ðŸ” Scan Product")),e.createElement(y,{id:"name",type:"text",value:a.name,onChange:t=>s("name",t.target.value),className:"mt-1 block w-full",required:!0}),e.createElement(c,{message:l.name,className:"mt-2"})),e.createElement("div",null,e.createElement("div",{className:"flex justify-between items-center"},e.createElement(i,{htmlFor:"description",value:"Description"}),e.createElement("button",{type:"button",onClick:S,disabled:x||!a.name,className:"px-2 py-1 text-xs bg-green-600 dark:bg-green-500 text-white rounded-md hover:bg-green-700 dark:hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 dark:focus:ring-green-400 dark:focus:ring-offset-gray-800 disabled:opacity-50"},x?"Generating...":"Generate with AI")),e.createElement("textarea",{id:"description",value:a.description,onChange:t=>s("description",t.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 shadow-sm focus:border-blue-300 dark:focus:border-blue-400 focus:ring focus:ring-blue-200 dark:focus:ring-blue-400",rows:"4",required:!0}),e.createElement(c,{message:l.description,className:"mt-2"})),e.createElement("div",null,e.createElement(i,{htmlFor:"nutritional_facts",value:"Nutritional Facts"}),e.createElement("textarea",{id:"nutritional_facts",value:typeof a.nutritional_facts=="object"?JSON.stringify(a.nutritional_facts,null,2):a.nutritional_facts,onChange:t=>s("nutritional_facts",t.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 shadow-sm focus:border-blue-300 dark:focus:border-blue-400 focus:ring focus:ring-blue-200 dark:focus:ring-blue-400",rows:"4",placeholder:"Enter nutritional information such as calories, protein, fats, etc."}),e.createElement(c,{message:l.nutritional_facts,className:"mt-2"})),h&&e.createElement("div",{className:"bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded relative",role:"alert"},e.createElement("strong",{className:"font-bold"},"Error:"," "),e.createElement("span",{className:"block sm:inline"},h)),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement(i,{htmlFor:"price",value:"Price"}),e.createElement(y,{id:"price",type:"number",step:"0.01",value:a.price,onChange:t=>s("price",t.target.value),className:"mt-1 block w-full",required:!0}),e.createElement(c,{message:l.price,className:"mt-2"})),e.createElement("div",null,e.createElement(i,{htmlFor:"stock_quantity",value:"Stock Quantity"}),e.createElement(y,{id:"stock_quantity",type:"number",value:a.stock_quantity,onChange:t=>s("stock_quantity",t.target.value),className:"mt-1 block w-full",required:!0}),e.createElement(c,{message:l.stock_quantity,className:"mt-2"}))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement(i,{htmlFor:"category",value:"Category"}),e.createElement("select",{id:"category",value:a.category,onChange:t=>s("category",t.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 shadow-sm focus:border-blue-300 dark:focus:border-blue-400 focus:ring focus:ring-blue-200 dark:focus:ring-blue-400",required:!0},e.createElement("option",{value:""},"Select a category"),k&&k.map(t=>e.createElement("option",{key:t.value,value:t.value},t.icon," ",t.label))),e.createElement(c,{message:l.category,className:"mt-2"})),e.createElement("div",null,e.createElement(i,{htmlFor:"unit_type",value:"Unit Type"}),e.createElement("select",{id:"unit_type",value:a.unit_type,onChange:t=>s("unit_type",t.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 shadow-sm focus:border-blue-300 dark:focus:border-blue-400 focus:ring focus:ring-blue-200 dark:focus:ring-blue-400",required:!0},e.createElement("option",{value:"piece"},"By Piece"),e.createElement("option",{value:"kg"},"By Kilogram (kg)")),e.createElement(c,{message:l.unit_type,className:"mt-2"}))),e.createElement("div",null,e.createElement(i,{htmlFor:"image",value:"Product Image"}),e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center mt-1 space-y-2 sm:space-y-0 sm:space-x-2"},e.createElement("input",{type:"file",id:"image",onChange:O,className:"block w-full text-gray-700 dark:text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-gray-50 dark:file:bg-gray-700 file:text-gray-700 dark:file:text-gray-300 hover:file:bg-gray-100 dark:hover:file:bg-gray-600",accept:"image/*"}),e.createElement("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2"},e.createElement("button",{type:"button",onClick:()=>f(!0),className:"px-4 py-2 bg-green-600 dark:bg-green-500 text-white rounded-md hover:bg-green-700 dark:hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 dark:focus:ring-green-400 dark:focus:ring-offset-gray-800 whitespace-nowrap"},"ðŸ“· Take Photo"),e.createElement("button",{type:"button",onClick:()=>v(!0),className:"px-4 py-2 bg-indigo-600 dark:bg-indigo-500 text-white rounded-md hover:bg-indigo-700 dark:hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-indigo-400 dark:focus:ring-offset-gray-800 whitespace-nowrap"},"Browse Existing Images"),m&&e.createElement("button",{type:"button",onClick:T,className:"px-4 py-2 bg-red-600 dark:bg-red-500 text-white rounded-md hover:bg-red-700 dark:hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 dark:focus:ring-red-400 dark:focus:ring-offset-gray-800 whitespace-nowrap"},"ðŸ—‘ï¸ Clear"))),e.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1"},"Upload a new image, take a photo with your camera, or select an existing one from the products folder."),b&&e.createElement("div",{className:"mt-2"},e.createElement("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full"},e.createElement("div",{className:"h-full bg-blue-600 dark:bg-blue-500 rounded-full",style:{width:`${b.percentage}%`}})),e.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1"},b.percentage,"% Uploaded")),e.createElement(c,{message:l.image,className:"mt-2"}),e.createElement("div",{className:"mt-4"},e.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2"},m?"Image Preview:":"No image selected:"),m?e.createElement("div",{className:"relative"},e.createElement("img",{src:m,alt:"Product preview",className:"h-32 w-32 object-contain rounded-lg border border-gray-200 dark:border-gray-700 bg-white"}),e.createElement("div",{className:"absolute top-0 right-0 bg-green-500 text-white text-xs px-1 rounded-bl"},"New")):e.createElement("div",{className:"relative"},e.createElement("div",{className:"h-32 w-32 flex items-center justify-center bg-gray-100 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-700"},e.createElement("span",{className:"text-gray-400 dark:text-gray-500"},"No image")),e.createElement("div",{className:"absolute top-0 right-0 bg-gray-500 text-white text-xs px-1 rounded-bl"},"Placeholder")))),e.createElement("div",null,e.createElement(i,{value:"Associated Recipes"}),e.createElement("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},C.map(t=>e.createElement("label",{key:t.id,className:"flex items-center"},e.createElement("input",{type:"checkbox",value:t.id,checked:a.recipe_ids.includes(t.id),onChange:n=>{const r=n.target.checked?[...a.recipe_ids,t.id]:a.recipe_ids.filter(o=>o!==t.id);s("recipe_ids",r)},className:"rounded border-gray-300 dark:border-gray-700 text-blue-600 dark:text-blue-500 shadow-sm focus:border-blue-300 dark:focus:border-blue-400 focus:ring focus:ring-blue-200 dark:focus:ring-blue-400 dark:bg-gray-800"}),e.createElement("span",{className:"ml-2 text-gray-700 dark:text-gray-300"},t.title)))),e.createElement(c,{message:l.recipe_ids,className:"mt-2"})),e.createElement("div",{className:"flex items-center justify-end space-x-4"},e.createElement($,{href:route("admin.products.index"),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-indigo-400 dark:focus:ring-offset-gray-800"},"Cancel"),e.createElement("button",{type:"submit",disabled:w,className:"px-4 py-2 bg-blue-600 dark:bg-blue-500 text-white rounded-md hover:bg-blue-700 dark:hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400 dark:focus:ring-offset-gray-800"},w?"Creating...":"Create Product"))))))),e.createElement(J,{isOpen:_,onClose:()=>v(!1),onSelect:R,type:"products",title:"Select Product Image"}),e.createElement(K,{isOpen:I,onClose:()=>f(!1),onCapture:B,title:"Take Product Photo"}),e.createElement(Q,{isOpen:P,onClose:()=>p(!1),onRecognitionComplete:j}))}export{ue as default};
