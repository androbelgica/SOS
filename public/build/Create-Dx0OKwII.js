import{q as Y,r as n,v as Q,R as e,$ as q,Y as J}from"./app2.js";import{M as $}from"./MainLayout-B06OhM-w.js";import{I as i}from"./InputLabel-BvFC6EAv.js";import{T as y,I as c}from"./InputError-ChmX8D1f.js";import{I as z}from"./ImageBrowser-foy8GHZg.js";import"./FlashMessage-CcTVzuzS.js";import"./NotificationDropdown-Bq8s4d9o.js";import"./transition-Cpe-sHT0.js";import"./dialog-D-Cuu6HU.js";import"./XMarkIcon-Dw0WrAo0.js";import"./CheckCircleIcon-C2jnGy7x.js";function xe({auth:L,products:j}){const{asset:X}=Y().props,[K,ee]=n.useState(Date.now()),[x,E]=n.useState(null),[R,C]=n.useState(null),[A,S]=n.useState(!1),[te,re]=n.useState(!1),[ae,le]=n.useState(!1),[se,ne]=n.useState(!1),[_,oe]=n.useState(null),[d,p]=n.useState([""]),[u,v]=n.useState([""]);n.useEffect(()=>{console.log("Create Recipe component mounted")},[]);const{data:m,setData:l,post:U,processing:M,errors:o,reset:T,progress:h}=Q({title:"",description:"",ingredients:[],instructions:[],cooking_time:"",difficulty_level:"medium",image:null,video:null,youtube_url:"",product_ids:[]}),W=t=>{const r=t.target.files[0];if(l("image",r),r){const a=new FileReader;a.onload=s=>{E(s.target.result)},a.readAsDataURL(r)}},B=t=>{console.log("Selected image:",t),l("image_url",t.url),((a,s)=>{const k=new Image;k.onload=()=>{console.log("Original URL loaded successfully:",a),s(a)},k.onerror=()=>{console.error("Original URL failed:",a);const g=a.replace("/storage/","/storage/public/");console.log("Trying alternative URL 1:",g);const w=new Image;w.onload=()=>{console.log("Alternative URL 1 loaded successfully:",g),s(g)},w.onerror=()=>{console.error("Alternative URL 1 failed:",g);const f=a.replace("/storage/recipes/","/storage/public/recipes/");console.log("Trying alternative URL 2:",f);const I=new Image;I.onload=()=>{console.log("Alternative URL 2 loaded successfully:",f),s(f)},I.onerror=()=>{console.error("Alternative URL 2 failed:",f);const b=a.replace("/storage/recipes/","/storage/public/public/recipes/");console.log("Trying alternative URL 3:",b);const N=new Image;N.onload=()=>{console.log("Alternative URL 3 loaded successfully:",b),s(b)},N.onerror=()=>{console.error("Alternative URL 3 failed:",b),s(a)},N.src=b},I.src=f},w.src=g},k.src=a})(t.url,a=>{E(a)})},D=t=>{const r=t.target.files[0];if(l("video",r),r){const a=URL.createObjectURL(r);C(a)}},F=(t,r)=>{const a=[...d];a[t]=r,p(a),l("ingredients",a.filter(s=>s.trim()!==""))},P=()=>{p([...d,""])},G=t=>{const r=[...d];r.splice(t,1),p(r),l("ingredients",r.filter(a=>a.trim()!==""))},V=(t,r)=>{const a=[...u];a[t]=r,v(a),l("instructions",a.filter(s=>s.trim()!==""))},Z=()=>{v([...u,""])},H=t=>{const r=[...u];r.splice(t,1),v(r),l("instructions",r.filter(a=>a.trim()!==""))},O=t=>{t.preventDefault(),l("ingredients",d.filter(r=>r.trim()!=="")),l("instructions",u.filter(r=>r.trim()!=="")),U(route("admin.recipes.store"),{forceFormData:!0,onSuccess:()=>{T(),E(null),C(null),p([""]),v([""])}})};return e.createElement($,{auth:L},e.createElement(q,{title:"Create New Recipe"}),e.createElement("div",{className:"py-12"},e.createElement("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},e.createElement("div",{className:"p-6"},e.createElement("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-gray-100 mb-6"},"Create New Recipe"),e.createElement("form",{onSubmit:O,className:"space-y-6"},e.createElement("div",null,e.createElement(i,{htmlFor:"title",value:"Title"}),e.createElement(y,{id:"title",type:"text",value:m.title,onChange:t=>l("title",t.target.value),className:"mt-1 block w-full",required:!0}),e.createElement(c,{message:o.title,className:"mt-2"})),e.createElement("div",null,e.createElement("div",{className:"flex justify-between items-center"},e.createElement(i,{htmlFor:"description",value:"Description"})),e.createElement("textarea",{id:"description",value:m.description,onChange:t=>l("description",t.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 shadow-sm focus:border-blue-300 dark:focus:border-blue-400 focus:ring focus:ring-blue-200 dark:focus:ring-blue-400",rows:"4",required:!0}),e.createElement(c,{message:o.description,className:"mt-2"}),_&&e.createElement("div",{className:"mt-2 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded relative",role:"alert"},e.createElement("strong",{className:"font-bold"},"Error:"," "),e.createElement("span",{className:"block sm:inline"},_))),e.createElement("div",null,e.createElement(i,{htmlFor:"cooking_time",value:"Cooking Time (minutes)"}),e.createElement(y,{id:"cooking_time",type:"number",min:"1",value:m.cooking_time,onChange:t=>l("cooking_time",t.target.value),className:"mt-1 block w-full",required:!0}),e.createElement(c,{message:o.cooking_time,className:"mt-2"})),e.createElement("div",null,e.createElement(i,{htmlFor:"difficulty_level",value:"Difficulty Level"}),e.createElement("select",{id:"difficulty_level",value:m.difficulty_level,onChange:t=>l("difficulty_level",t.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 shadow-sm focus:border-blue-300 dark:focus:border-blue-400 focus:ring focus:ring-blue-200 dark:focus:ring-blue-400",required:!0},e.createElement("option",{value:"easy"},"Easy"),e.createElement("option",{value:"medium"},"Medium"),e.createElement("option",{value:"hard"},"Hard")),e.createElement(c,{message:o.difficulty_level,className:"mt-2"})),e.createElement("div",null,e.createElement(i,{htmlFor:"image",value:"Recipe Image"}),e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center mt-1 space-y-2 sm:space-y-0 sm:space-x-2"},e.createElement("input",{id:"image",type:"file",onChange:W,className:"block w-full text-gray-700 dark:text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-gray-50 dark:file:bg-gray-700 file:text-gray-700 dark:file:text-gray-300 hover:file:bg-gray-100 dark:hover:file:bg-gray-600",accept:"image/*"}),e.createElement("button",{type:"button",onClick:()=>S(!0),className:"px-4 py-2 bg-indigo-600 dark:bg-indigo-500 text-white rounded-md hover:bg-indigo-700 dark:hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-indigo-400 dark:focus:ring-offset-gray-800 whitespace-nowrap"},"Browse Existing Images")),e.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1"},"Upload a new image or select an existing one from the recipes folder."),e.createElement(c,{message:o.image,className:"mt-2"}),x&&e.createElement("div",{className:"mt-2"},e.createElement("img",{src:x,alt:"Preview",className:"h-32 w-32 object-cover rounded-md",onError:t=>{console.error("Image preview failed to load:",x),t.target.onerror=null,t.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2YwZjBmMCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIiBmaWxsPSIjYWFhYWFhIj5JbWFnZSBOb3QgRm91bmQ8L3RleHQ+PC9zdmc+"}}))),e.createElement("div",null,e.createElement(i,{htmlFor:"video",value:"Recipe Video (Optional)"}),e.createElement("input",{id:"video",type:"file",onChange:D,className:"mt-1 block w-full text-gray-700 dark:text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-gray-50 dark:file:bg-gray-700 file:text-gray-700 dark:file:text-gray-300 hover:file:bg-gray-100 dark:hover:file:bg-gray-600",accept:"video/mp4,video/quicktime,video/x-msvideo,video/x-flv,video/x-ms-wmv"}),e.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1"},"Supported formats: MP4, MOV, AVI, FLV, WMV (max 20MB)"),e.createElement(c,{message:o.video,className:"mt-2"}),R&&e.createElement("div",{className:"mt-2"},e.createElement("video",{src:R,controls:!0,className:"h-48 w-full object-cover rounded-md"}))),e.createElement("div",null,e.createElement(i,{htmlFor:"youtube_url",value:"YouTube Video URL (Optional)"}),e.createElement(y,{id:"youtube_url",type:"url",value:m.youtube_url,onChange:t=>l("youtube_url",t.target.value),className:"mt-1 block w-full",placeholder:"https://www.youtube.com/watch?v=..."}),e.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1"},"Enter a YouTube video URL (e.g., https://www.youtube.com/watch?v=...)"),e.createElement(c,{message:o.youtube_url,className:"mt-2"})),h&&e.createElement("div",{className:"mt-2"},e.createElement("p",{className:"text-sm text-gray-600 mb-1"},"Uploading files..."),e.createElement("progress",{value:h.percentage,max:"100",className:"w-full"},h.percentage,"%")),e.createElement("div",null,e.createElement("div",{className:"flex justify-between items-center"},e.createElement(i,{value:"Ingredients"})),d.map((t,r)=>e.createElement("div",{key:r,className:"flex items-center mt-2"},e.createElement(y,{type:"text",value:t,onChange:a=>F(r,a.target.value),className:"block w-full",placeholder:`Ingredient ${r+1}`}),e.createElement("button",{type:"button",onClick:()=>G(r),className:"ml-2 text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300",disabled:d.length===1},"Remove"))),e.createElement("button",{type:"button",onClick:P,className:"mt-2 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300"},"Add Ingredient"),e.createElement(c,{message:o.ingredients,className:"mt-2"})),e.createElement("div",null,e.createElement("div",{className:"flex justify-between items-center"},e.createElement(i,{value:"Instructions"})),u.map((t,r)=>e.createElement("div",{key:r,className:"flex items-start mt-2"},e.createElement("div",{className:"flex-shrink-0 mt-2 mr-2 text-gray-900 dark:text-gray-100"},r+1,"."),e.createElement("textarea",{value:t,onChange:a=>V(r,a.target.value),className:"block w-full rounded-md border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 shadow-sm focus:border-blue-300 dark:focus:border-blue-400 focus:ring focus:ring-blue-200 dark:focus:ring-blue-400",rows:"2",placeholder:`Step ${r+1}`}),e.createElement("button",{type:"button",onClick:()=>H(r),className:"ml-2 text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300",disabled:u.length===1},"Remove"))),e.createElement("button",{type:"button",onClick:Z,className:"mt-2 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300"},"Add Step"),e.createElement(c,{message:o.instructions,className:"mt-2"})),e.createElement("div",null,e.createElement(i,{value:"Associated Products"}),e.createElement("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},j.map(t=>e.createElement("label",{key:t.id,className:"flex items-center"},e.createElement("input",{type:"checkbox",value:t.id,checked:m.product_ids.includes(t.id),onChange:r=>{const a=r.target.checked?[...m.product_ids,t.id]:m.product_ids.filter(s=>s!==t.id);l("product_ids",a)},className:"rounded border-gray-300 dark:border-gray-700 text-blue-600 shadow-sm focus:border-blue-300 dark:focus:border-blue-400 focus:ring focus:ring-blue-200 dark:focus:ring-blue-400"}),e.createElement("span",{className:"ml-2 text-gray-900 dark:text-gray-100"},t.name)))),e.createElement(c,{message:o.product_ids,className:"mt-2"})),e.createElement("div",{className:"flex items-center justify-end mt-4"},e.createElement(J,{href:route("admin.recipes.index"),className:"underline text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 mr-4"},"Cancel"),e.createElement("button",{type:"submit",className:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 active:bg-blue-800 focus:outline-none focus:border-blue-700 focus:ring focus:ring-blue-300 disabled:opacity-25 transition",disabled:M},"Create Recipe"))))))),e.createElement(z,{isOpen:A,onClose:()=>S(!1),onSelect:B,type:"recipes",title:"Select Recipe Image"}))}export{xe as default};
