import{r as g,v as x,R as e,$ as F,Y as L,m as A}from"./app2.js";import{A as j}from"./AdminLayout-Cv-SYGq4.js";import"./FlashMessage-CcTVzuzS.js";import"./NotificationDropdown-Bq8s4d9o.js";import"./transition-Cpe-sHT0.js";function R({auth:b,order:t,deliveryStaff:l}){const[U,u]=g.useState(!1),[z,p]=g.useState(!1),[n,m]=g.useState(!1),{data:r,setData:c,put:f,processing:d,errors:y}=x({status:t.status,assigned_to:t.assigned_to||""}),{data:s,setData:E,put:h,processing:i}=x({payment_status:t.payment_status}),w={pending:"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200",processing:"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200",delivered:"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200",cancelled:"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200"},v={pending:"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200",paid:"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200",failed:"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200"},k=a=>{c("status",a.target.value),a.target.value!=="for_delivery"&&c("assigned_to","")},N=a=>{E("payment_status",a.target.value)},_=a=>{a.preventDefault(),u(!0),f(route("admin.orders.status.update",t.id),{onSuccess:()=>{u(!1)}})},C=a=>{a.preventDefault(),p(!0),h(route("admin.orders.payment-status.update",t.id),{onSuccess:()=>{p(!1)}})},S=()=>{m(!0),A.post(route("admin.orders.labels.generate",t.id),{},{onSuccess:()=>{m(!1)},onError:()=>{m(!1)}})},P=()=>{window.open(route("admin.orders.labels.print",t.id),"_blank")},o=a=>{const D=new Date(a);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(D)};return e.createElement(j,{auth:b,title:`Order #${t.id}`},e.createElement(F,{title:`Order #${t.id} - Admin Dashboard`}),e.createElement("div",{className:"mb-6"},e.createElement(L,{href:route("admin.orders.index"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all duration-200"},e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})),"Back to Orders")),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6"},e.createElement("div",{className:"lg:col-span-2"},e.createElement("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white"},"Order Summary"),e.createElement("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${w[t.status]}`},t.status.charAt(0).toUpperCase()+t.status.slice(1))),e.createElement("div",{className:"p-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2"},"Order Details"),e.createElement("div",{className:"space-y-2"},e.createElement("p",{className:"text-sm text-gray-700 dark:text-gray-300"},e.createElement("span",{className:"font-medium"},"Order ID:")," ","#",t.id),e.createElement("p",{className:"text-sm text-gray-700 dark:text-gray-300"},e.createElement("span",{className:"font-medium"},"Date:")," ",o(t.created_at)),e.createElement("p",{className:"text-sm text-gray-700 dark:text-gray-300"},e.createElement("span",{className:"font-medium"},"Payment Status:")," ",e.createElement("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${v[t.payment_status]}`},t.payment_status.charAt(0).toUpperCase()+t.payment_status.slice(1))),e.createElement("p",{className:"text-sm text-gray-700 dark:text-gray-300"},e.createElement("span",{className:"font-medium"},"Payment Method:")," ",t.payment_method==="cod"&&"Cash on Delivery (COD)",t.payment_method==="gcash"&&"GCash",t.payment_method==="maya"&&"Maya"))),e.createElement("div",null,e.createElement("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2"},"Customer Information"),e.createElement("div",{className:"space-y-2"},e.createElement("p",{className:"text-sm text-gray-700 dark:text-gray-300"},e.createElement("span",{className:"font-medium"},"Name:")," ",t.user.name),e.createElement("p",{className:"text-sm text-gray-700 dark:text-gray-300"},e.createElement("span",{className:"font-medium"},"Email:")," ",t.user.email)))),e.createElement("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2"},"Shipping Address"),e.createElement("p",{className:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-line"},t.shipping_address)),e.createElement("div",null,e.createElement("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2"},"Billing Address"),e.createElement("p",{className:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-line"},t.billing_address))))),e.createElement("div",{className:"mt-6 bg-white dark:bg-gray-800 shadow-md rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white"},"Order Items")),e.createElement("div",{className:"overflow-x-auto"},e.createElement("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},e.createElement("thead",{className:"bg-gray-50 dark:bg-gray-700"},e.createElement("tr",{key:"header-row"},e.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Product"),e.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Price"),e.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Quantity"),e.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Subtotal"))),e.createElement("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},t.items&&t.items.map(a=>e.createElement("tr",{key:a.id,className:"hover:bg-gray-50 dark:hover:bg-gray-700"},e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"flex-shrink-0 h-10 w-10"},a.product.image_url?e.createElement("img",{className:"h-10 w-10 rounded-md object-cover",src:a.product.image_url,alt:a.product.name}):e.createElement("div",{className:"h-10 w-10 rounded-md bg-gray-200 dark:bg-gray-700 flex items-center justify-center"},e.createElement("span",{className:"text-gray-500 dark:text-gray-400 text-xs"},"No img"))),e.createElement("div",{className:"ml-4"},e.createElement("div",{className:"text-sm font-medium text-gray-900 dark:text-white"},a.product.name)))),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},"₱",parseFloat(a.price).toFixed(2),a.product.unit_type==="kg"?"/kg":"/pc"),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},a.quantity,a.product.unit_type==="kg"?"g":" pcs"),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},"₱",(a.product.unit_type==="kg"?parseFloat(a.price)*(a.quantity/1e3):parseFloat(a.price)*a.quantity).toFixed(2))))),e.createElement("tfoot",{className:"bg-gray-50 dark:bg-gray-700"},e.createElement("tr",{key:"total-row"},e.createElement("td",{colSpan:"3",className:"px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white"},"Total:"),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},"₱",parseFloat(t.total_amount).toFixed(2)))))))),e.createElement("div",{className:"lg:col-span-1"},e.createElement("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white"},"Order Actions")),e.createElement("div",{className:"p-6"},e.createElement("form",{onSubmit:_,className:"mb-6"},e.createElement("div",{className:"mb-4"},e.createElement("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Update Order Status"),e.createElement("select",{id:"status",name:"status",value:r.status,onChange:k,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",disabled:t.status==="delivered"},e.createElement("option",{value:"pending"},"Pending"),e.createElement("option",{value:"processing"},"Processing"),e.createElement("option",{value:"for_delivery"},"For Delivery"),e.createElement("option",{value:"delivered",disabled:s.payment_status!=="paid"},"Delivered"),e.createElement("option",{value:"cancelled"},"Cancelled")),r.status==="delivered"&&s.payment_status!=="paid"&&e.createElement("p",{className:"text-xs text-red-500 mt-1"},"Cannot set to Delivered unless payment is marked as Paid.")),r.status==="for_delivery"&&e.createElement("div",{className:"mb-4"},e.createElement("label",{htmlFor:"assigned_to",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Assign Delivery Staff"),e.createElement("select",{id:"assigned_to",name:"assigned_to",value:r.assigned_to,onChange:a=>c("assigned_to",a.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",required:!0},e.createElement("option",{value:""},"Select Delivery Staff"),l&&l.length>0?l.map(a=>e.createElement("option",{key:a.id,value:a.id},a.name)):e.createElement("option",{value:"",disabled:!0},"No delivery staff available")),y.assigned_to&&e.createElement("p",{className:"text-xs text-red-500 mt-1"},y.assigned_to)),e.createElement("button",{type:"submit",disabled:d||r.status===t.status||r.status==="for_delivery"&&!r.assigned_to,className:`w-full inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 ${d||r.status===t.status||r.status==="for_delivery"&&!r.assigned_to?"opacity-50 cursor-not-allowed":""}`},d?e.createElement(e.Fragment,null,e.createElement("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},e.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),"Updating..."):"Update Status")),e.createElement("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6 mb-6"}),e.createElement("form",{onSubmit:C},e.createElement("div",{className:"mb-4"},e.createElement("label",{htmlFor:"payment_status",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Update Payment Status"),e.createElement("select",{id:"payment_status",name:"payment_status",value:s.payment_status,onChange:N,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"},e.createElement("option",{value:"pending"},"Pending"),e.createElement("option",{value:"paid"},"Paid"),e.createElement("option",{value:"failed"},"Failed"))),e.createElement("button",{type:"submit",disabled:i||s.payment_status===t.payment_status,className:`w-full inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 ${i||s.payment_status===t.payment_status?"opacity-50 cursor-not-allowed":""}`},i?e.createElement(e.Fragment,null,e.createElement("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},e.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),"Updating..."):"Update Payment Status")),t.status==="processing"&&e.createElement("div",{className:"mt-6 border-t border-gray-200 dark:border-gray-700 pt-6 mb-6"},e.createElement("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-4"},"Product Labels"),e.createElement("div",{className:"space-y-4"},e.createElement("button",{type:"button",onClick:S,disabled:n,className:`w-full inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 ${n?"opacity-50 cursor-not-allowed":""}`},n?e.createElement(e.Fragment,null,e.createElement("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},e.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),"Generating Labels..."):e.createElement(e.Fragment,null,e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})),"Generate Product Labels")),e.createElement("button",{type:"button",onClick:P,className:"w-full inline-flex justify-center items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md shadow-sm text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})),"Print All Labels")),e.createElement("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400"},"Labels include QR codes that customers can scan to verify products before payment.")),e.createElement("div",{className:"mt-6 border-t border-gray-200 dark:border-gray-700 pt-4"},e.createElement("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2"},"Order Timeline"),e.createElement("div",{className:"flow-root"},e.createElement("ul",{className:"-mb-8"},e.createElement("li",{key:"order-placed"},e.createElement("div",{className:"relative pb-8"},e.createElement("span",{className:"absolute top-4 left-4 -ml-px h-full w-0.5 bg-gray-200 dark:bg-gray-700","aria-hidden":"true"}),e.createElement("div",{className:"relative flex space-x-3"},e.createElement("div",null,e.createElement("span",{className:"h-8 w-8 rounded-full bg-green-500 flex items-center justify-center ring-8 ring-white dark:ring-gray-800"},e.createElement("svg",{className:"h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},e.createElement("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})))),e.createElement("div",{className:"min-w-0 flex-1 pt-1.5 flex justify-between space-x-4"},e.createElement("div",null,e.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Order placed")),e.createElement("div",{className:"text-right text-sm whitespace-nowrap text-gray-500 dark:text-gray-400"},o(t.created_at)))))),e.createElement("li",{key:"current-status"},e.createElement("div",{className:"relative pb-8"},e.createElement("div",{className:"relative flex space-x-3"},e.createElement("div",null,e.createElement("span",{className:"h-8 w-8 rounded-full bg-blue-500 flex items-center justify-center ring-8 ring-white dark:ring-gray-800"},e.createElement("svg",{className:"h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},e.createElement("path",{fillRule:"evenodd",d:"M10 2a8 8 0 100 16 8 8 0 000-16zm0 14a6 6 0 100-12 6 6 0 000 12z",clipRule:"evenodd"})))),e.createElement("div",{className:"min-w-0 flex-1 pt-1.5 flex justify-between space-x-4"},e.createElement("div",null,e.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Current status:"," ",e.createElement("span",{className:"font-medium"},t.status.charAt(0).toUpperCase()+t.status.slice(1)))),e.createElement("div",{className:"text-right text-sm whitespace-nowrap text-gray-500 dark:text-gray-400"},o(t.updated_at))))))))))))))}export{R as default};
